<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Filter Nesting Attempts Based on Expected Nest Phenological Periods — nw.filterphenology • nestwatchR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Filter Nesting Attempts Based on Expected Nest Phenological Periods — nw.filterphenology"><meta name="description" content="To provide additional checks on data quality before analysis, an analyst may want to filter out nesting attempts which were
recorded to have nesting phenologies of unexpectedly long lengths. This function allows an analyst to specify species-specific values for nest phenologies
using expected days in the lay, incubation, nestling, and total nesting periods. By defining these allowable time frames an analyst can flag or
remove &quot;run-on&quot; nest attempts or nests which do not match the specie's life history."><meta property="og:description" content="To provide additional checks on data quality before analysis, an analyst may want to filter out nesting attempts which were
recorded to have nesting phenologies of unexpectedly long lengths. This function allows an analyst to specify species-specific values for nest phenologies
using expected days in the lay, incubation, nestling, and total nesting periods. By defining these allowable time frames an analyst can flag or
remove &quot;run-on&quot; nest attempts or nests which do not match the specie's life history."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nestwatchR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.100</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/a_Intro-and-Data-Access.html">Introduction to NestWatch Data and Data Access</a></li>
    <li><a class="dropdown-item" href="../articles/b_Data-Cleaning.html">Conduct Common NestWatch Data Cleaning Procedures</a></li>
    <li><a class="dropdown-item" href="../articles/c_Data-Estimation.html">Estimate NestWatch Summary Dates</a></li>
    <li><a class="dropdown-item" href="../articles/d_Data-Filtering.html">Filter NestWatch Data on Finer Scales</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Function Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/engagement-center/nestwatchR/" aria-label="github"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Filter Nesting Attempts Based on Expected Nest Phenological Periods</h1>
      <small class="dont-index">Source: <a href="https://github.com/engagement-center/nestwatchR/blob/HEAD/R/nw.filterphenology.R" class="external-link"><code>R/nw.filterphenology.R</code></a></small>
      <div class="d-none name"><code>nw.filterphenology.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>To provide additional checks on data quality before analysis, an analyst may want to filter out nesting attempts which were
recorded to have nesting phenologies of unexpectedly long lengths. This function allows an analyst to specify species-specific values for nest phenologies
using expected days in the lay, incubation, nestling, and total nesting periods. By defining these allowable time frames an analyst can flag or
remove "run-on" nest attempts or nests which do not match the specie's life history.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nw.filterphenology</span><span class="op">(</span><span class="va">data</span>, <span class="va">mode</span>, <span class="va">max_phenology</span>, <span class="va">trim_to_active</span>, output <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>dataframe; A dataframe of merged NestWatch attempt and visits data. Date columns must have class <code>Date</code>
and Datetime columns must have class <code>POSIXct</code>.</p></dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p><code>"flag"</code> or <code>"remove"</code>; A character string defining if the analyst wants the identified nesting attempts to be
flagged with "FLAGGED" in a new column, or removed from the dataset.</p></dd>


<dt id="arg-max-phenology">max_phenology<a class="anchor" aria-label="anchor" href="#arg-max-phenology"></a></dt>
<dd><p>dataframe; A simple dataframe with one row for each species of interest and the following column structure:</p><ul><li><p><strong>Species</strong>: The 6-letter species code for each species.</p></li>
<li><p><strong>Lay</strong>: The number of days representing the maximum expected laying period for each species.</p></li>
<li><p><strong>Incubation</strong>: The number of days representing the maximum expected incubation period (between clutch complete and hatch) for each species.</p></li>
<li><p><strong>Nestling</strong>: The number of days representing the maximum expected nesting period (hatch and last fledge) for each species.</p></li>
<li><p><strong>Total</strong>: The number of days representing the maximum expected total nesting period (spanning first initial nest building to last fledge) for each species.</p></li>
</ul></dd>


<dt id="arg-trim-to-active">trim_to_active<a class="anchor" aria-label="anchor" href="#arg-trim-to-active"></a></dt>
<dd><p>logical; TRUE or FALSE indicating if nest check data should be trimmed to include only those rows where the nest was active
(in build, lay, incubation, presence of life young). The first check observing a fledge or fail event is retained, but subsequent checks would be
targeted for flag/removal. Flag/removal follows <code>mode</code>.</p></dd>


<dt id="arg-output">output<a class="anchor" aria-label="anchor" href="#arg-output"></a></dt>
<dd><p>character; An optional character string to custom name the output dataframe</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>dataframe</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function calculates the number of days between <code>First.Lay.Date</code>, <code>Hatch.Date</code>, and <code>Fledge.Date</code> date values, comparing
each to the user-provided acceptable date spans for each nest phase. Not all attempts contain these summary dates. An analyst may choose to explore
<a href="nw.estclutchsize.html">nw.estclutchsize</a>, <a href="nw.estfirstlay.html">nw.estfirstlay</a>, <a href="nw.esthatch.html">nw.esthatch</a>, and <a href="nw.estfledge.html">nw.estfledge</a> functions
to estimate these summary dates from the individual nest visit data prior to using this function. As an additional check, this function calculates
the date span between the first occurrence of an incomplete nest, complete nest, observed egg, or observed young and last active date (either the last
observation of eggs/live young or the first 0-egg/young count indicating fail/fledge) and compares this date span to the user-provided "total nesting
period" value.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create phenology dataframe</span></span></span>
<span class="r-in"><span><span class="va">phenology</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"carwre"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        lay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>,          <span class="co"># max observed</span></span></span>
<span class="r-in"><span>                        incubation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>,  <span class="co"># mean plus some extra</span></span></span>
<span class="r-in"><span>                        nestling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>,    <span class="co"># mean plus some extra</span></span></span>
<span class="r-in"><span>                        total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>       <span class="co"># mean plus some extra</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simplified NestWatch dataset with nest summary dates</span></span></span>
<span class="r-in"><span><span class="co"># Attempts 3 &amp; 4 should be flagged (too long in incubation and nestling phases respectively)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Attempt.ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   Species.Code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"carwre"</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   First.Lay.Date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2024-05-01"</span>, <span class="st">"2024-05-01"</span>,</span></span>
<span class="r-in"><span>                                              <span class="st">"2024-05-01"</span>, <span class="st">"2024-05-01"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   Hatch.Date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2024-05-20"</span>, <span class="st">"2024-05-21"</span>, <span class="st">"2024-06-10"</span>, <span class="st">"2024-05-21"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   Fledge.Date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2024-06-05"</span>, <span class="cn">NA</span>, <span class="st">"2024-06-25"</span>, <span class="st">"2024-06-30"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   Visit.Datetime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   Outcome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s1"</span>, <span class="st">"f"</span>, <span class="st">"s1"</span>, <span class="st">"s1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   Nest.Status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">nw.filterphenology</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, max_phenology <span class="op">=</span> <span class="va">phenology</span>, mode <span class="op">=</span> <span class="st">"flag"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in nw.filterphenology(data = data, max_phenology = phenology, mode = "flag"):</span> Column 'Visit.Datetime' must be of class 'POSIXct' or 'POSIXt'.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simplified NestWatch dataset without nest summary dates</span></span></span>
<span class="r-in"><span><span class="co"># (will look at total nest attempt duration from visit dates)</span></span></span>
<span class="r-in"><span><span class="co"># Attempt "2" should be flagged as being too long.</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Attempt.ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   Species.Code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"carwre"</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   First.Lay.Date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   Hatch.Date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   Fledge.Date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   Visit.Datetime <span class="op">=</span></span></span>
<span class="r-in"><span>                   <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2024-05-01"</span>, <span class="st">"2024-06-15"</span>,</span></span>
<span class="r-in"><span>                                <span class="st">"2024-05-01"</span>, <span class="st">"2024-07-30"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   Outcome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s1"</span>, <span class="st">"s1"</span>, <span class="st">"s1"</span>, <span class="st">"s1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   Nest.Status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">nw.filterphenology</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, max_phenology <span class="op">=</span> <span class="va">phenology</span>, mode <span class="op">=</span> <span class="st">"flag"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in pull(., Visit.ID):</span> Can't extract column with `!!enquo(var)`.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">✖</span> Subscript `!!enquo(var)` must be a location, not an integer `NA`.</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kim Savides, Robyn L. Bailey, David N. Bonter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

